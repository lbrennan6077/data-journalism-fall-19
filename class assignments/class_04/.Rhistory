baltimore %>%
group_by(buyer_name) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills)) %>%
filter(str_detect(buyer_name, "Ri"))
# Rite-Aid of Maryland, Inc., 12.52 percent, 16.7 million pills out of 133.7 million pills sent to whole city.
baltimore %>%
group_by(buyer_name) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills)) %>%
filter(str_detect(buyer_name, "RI"))
# Rite-Aid of Maryland, Inc., 12.52 percent, 16.7 million pills out of 133.7 million pills sent to whole city.
baltimore %>%
group_by(buyer_name) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills)) %>%
filter(str_detect(buyer_name, "RIT"))
# Rite-Aid of Maryland, Inc., 12.52 percent, 16.7 million pills out of 133.7 million pills sent to whole city.
baltimore %>%
group_by(buyer_name) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills)) %>%
filter(str_detect(buyer_name, "RITE"))
# Rite-Aid of Maryland, Inc., 12.52 percent, 16.7 million pills out of 133.7 million pills sent to whole city.
baltimore_working <- baltimore %>%
mutate(rite_aid_y_n = case_when(
str_detect(buyer_name, "RITE") ~ "rite_aid_y",
TRUE ~ "rite_aid_n"
)) %>%
group_by(rite_aid_y_n) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills))
baltimore %>%
mutate(rite_aid_y_n = case_when(
str_detect(buyer_name, "RITE") ~ "rite_aid_y",
TRUE ~ "rite_aid_n"
)) %>%
group_by(rite_aid_y_n) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills))
baltimore %>%
mutate(rite_aid_y_n = case_when(
str_detect(buyer_name, "RITE") ~ "rite_aid_y",
TRUE ~ "rite_aid_n"
)) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_pharmacy = n()) %>%
mutate(total_pills = sum(shipments_per_pharmacy)) %>%
mutate(pharmacy_percent_total_shipments = round(((shipments_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills))
baltimore %>%
mutate(rite_aid_y_n = case_when(
str_detect(buyer_name, "RITE") ~ "rite_aid_y",
TRUE ~ "rite_aid_n"
)) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_pharmacy = n()) %>%
mutate(total_pills = sum(shipments_per_pharmacy)) %>%
mutate(pharmacy_percent_total_shipments = round(((shipments_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_shipments))
baltimore %>%
mutate(rite_aid_y_n = case_when(
str_detect(buyer_name, "RITE") ~ "rite_aid_y",
TRUE ~ "rite_aid_n"
)) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_pharmacy = n()) %>%
mutate(total_shipments = sum(shipments_per_pharmacy)) %>%
mutate(pharmacy_percent_total_shipments = round(((shipments_per_pharmacy/total_shipments)*100),2)) %>%
arrange(desc(pharmacy_percent_total_shipments))
baltimore %>%
ilter(drug_name == "HYDROCODONE") %>%
group_by(buyer_name) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(max_pills_in_shipment))
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
group_by(buyer_name) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(max_pills_in_shipment))
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
group_by(buyer_name) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(shipments))
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
group_by(combined_labeler_name, reporter_name, buyer_name) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(shipments))
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
mutate(pipeline = paste0(combined_labeler_name, " ",reporter_name," ",buyer_name)) %>%
group_by(pipeline) %>%
mutate()
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(shipments))
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
mutate(pipeline = paste0(combined_labeler_name, " ",reporter_name," ",buyer_name)) %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(shipments))
#
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
mutate(pipeline = paste0(combined_labeler_name, "--",reporter_name,"--",buyer_name)) %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(shipments))
#
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
mutate(pipeline = paste0(combined_labeler_name, "--",reporter_name,"--",buyer_name)) %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(total_pills))
# Shipments: SpecGx LLC--RITE AID MID-ATLANTIC--RITE AID OF MARYLAND, INC.	9087
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
mutate(pipeline = paste0(combined_labeler_name, "--",reporter_name,"--",buyer_name)) %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(avg_pills_per_shipment))
# Shipments: SpecGx LLC--RITE AID MID-ATLANTIC--RITE AID OF MARYLAND, INC.	9087
# Shipments: SpecGx LLC--RITE AID MID-ATLANTIC--RITE AID OF MARYLAND, INC.	2482900
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
mutate(pipeline = paste0(combined_labeler_name, "--",reporter_name,"--",buyer_name)) %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(avg_pills_per_shipment))
# Shipments: SpecGx LLC--RITE AID MID-ATLANTIC--RITE AID OF MARYLAND, INC.	9087
# Total Pills: SpecGx LLC--RITE AID MID-ATLANTIC--RITE AID OF MARYLAND, INC.	2482900
# Avg Pills Per Shipment: Actavis Pharma, Inc.--CARDINAL HEALTH--NEWCARE HOME HEALTH SERVICES14285.0746
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
mutate(pipeline = paste0(combined_labeler_name, "--",reporter_name,"--",buyer_name)) %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipment = mean(dosage_unit),
min_pills_in_shipment = min(dosage_unit),
max_pills_in_shipment = max(dosage_unit)
) %>%
arrange(desc(max_pills_in_shipment))
# Shipments: SpecGx LLC--RITE AID MID-ATLANTIC--RITE AID OF MARYLAND, INC.	9087
# Total Pills: SpecGx LLC--RITE AID MID-ATLANTIC--RITE AID OF MARYLAND, INC.	2482900
# Avg Pills Per Shipment: Actavis Pharma, Inc.--CARDINAL HEALTH--NEWCARE HOME HEALTH SERVICES 14285.0746
baltimore %>%
filter(dosage_unit >= 30000)
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
filter(dosage_unit >= 30000)
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
filter(dosage_unit >= 30000) %>%
mutate(pipeline = paste0(combined_labeler_name, "--",reporter_name,"--",buyer_name)) %>%
select(pipeline, transaction_date, dosage_unit, everything())
baltimore %>%
filter(drug_name == "HYDROCODONE") %>%
filter(dosage_unit == 48000) %>%
mutate(pipeline = paste0(combined_labeler_name, "--",reporter_name,"--",buyer_name)) %>%
select(pipeline, transaction_date, dosage_unit, everything())
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
view(baltimore)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load Baltimore data
baltimore <- (arcos-md-baltimore-city-24510-itemized.tsv)
view(baltimore)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load Baltimore data
arcos-md-baltimore-city-24510-itemized.tsv -> baltimore
# Load Baltimore data
arcos-md-baltimore-city-24510-itemized.tsv -> baltimore
# Load Baltimore data
baltimore -> (arcos-md-baltimore-city-24510-itemized.tsv)
# Load Baltimore data
baltimore -> read_tsv("arcos-md-baltimore-city-24510-itemized.tsv")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load Baltimore data
baltimore -> read_tsv("arcos-md-baltimore-city-24510-itemized.tsv")
# Load Baltimore data
baltimore -> read_tsv("data/arcos-md-baltimore-city-24510-itemized.tsv")
# Load Baltimore data
baltimore -> read_tsv("arcos-md-baltimore-city-24510-itemized.tsv")
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load Baltimore data
baltimore <- read_tsv("data/arcos-md-baltimore-city-24510-itemized.tsv")
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load Baltimore data
baltimore <- read_tsv("data/arcos-md-baltimore-city-24510-itemized.tsv")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load Baltimore data
baltimore <- read_tsv("data/arcos-md-baltimore-city-24510-itemized.tsv")
#view(baltimore)
glimpse(baltimore)
summary(baltimore)
baltimore <- clean_names(baltimore)
baltimore <- clean_names(baltimore)
baltimore %>%
group_by(buyer_name, buyer_address1, buyer_address2) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
arrange(desc(pills_per_pharmacy))
baltimore %>%
select(contains("baltimore")) %>%
group_by(reporter_name, reporter_address1, reporter_address2) %>%
summarise(pills_per_distributor = sum(dosage_unit)) %>%
arrange(desc(pills_per_distributor))
baltimore %>%
group_by(reporter_name, reporter_address1, reporter_address2) %>%
summarise(pills_per_distributor = sum(dosage_unit)) %>%
arrange(desc(pills_per_distributor))
baltimore %>%
filter(reporter_name == "MCKESSON CORPORATION")%>%
group_by(buyer_name, buyer_address1, buyer_address2) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
arrange(desc(pills_per_pharmacy))
baltimore %>%
filter(reporter_name == "MCKESSON CORPORATION")%>%
group_by(buyer_name, buyer_address1, buyer_address2) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
arrange(desc(pills_per_pharmacy))
#
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = (pills_per_pharmacy/total_pills)*100,2)
arrange(desc(pills_per_pharmacy))
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = (pills_per_pharmacy/total_pills)*100,2)
arrange((desc(pills_per_pharmacy))
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)
arrange(desc(pills_per_pharmacy))
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)
arrange(desc(pills_per_pharmacy)))
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)
arrange(desc(pills_per_pharmacy))
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)%>%
arrange(desc(pills_per_pharmacy))
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)%>%
arrange(desc(pills_per_pharmacy))
#RITE AID OF MARYLAND, INC., (percentage of pills) 1.251900e+01, (total pills) 133721503, (total number of pills to whole city)
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)%>%
arrange(desc(pills_per_pharmacy))
filter(buyer_name == "RITE AID")
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)%>%
arrange(desc(pills_per_pharmacy))
filter(buyer_name = "RITE AID")
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)%>%
arrange(desc(pills_per_pharmacy))%>%
filter(buyer_name == "RITE AID")
baltimore %>%
group_by(buyer_name)%>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills =sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills =(pills_per_pharmacy/total_pills)*100,2)%>%
arrange(desc(pills_per_pharmacy)) %>%
filter(buyer_name == "RITE AID")
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n"))%%
group_by(rite_aid_y_n)%>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
filter("RITE")
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
filter(buyer_name == "RITE")
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
filter(buyer_name == "RITE AID")
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))%>%
filter(buyer_name == "RITE AID")
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))%>%
filter(str_detect(buyer_name == "RITE")
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))%>%
filter(str_detect(buyer_name == "RITE"))
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group)) %>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2)) %>%
filter(str_detect(buyer_name, "RITE"))
baltimore %>%
group_by(buyer_name) %>%
summarise(shipments_per_group = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills)) %>%
filter(str_detect(buyer_name, "RITE"))
baltimore %>%
group_by(buyer_name) %>%
summarise(pills_per_pharmacy = sum(dosage_unit)) %>%
mutate(total_pills = sum(pills_per_pharmacy)) %>%
mutate(pharmacy_percent_total_pills = round(((pills_per_pharmacy/total_pills)*100),2)) %>%
arrange(desc(pharmacy_percent_total_pills)) %>%
filter(str_detect(buyer_name, "RITE"))
baltimore_working <- baltimore %>%
mutate(rite_aid_y_n = if_else(buyer_name == "RITE AID", "rite_aid_y", "rite_aid_n"))
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
baltimore_hyd_pipeline <- baltimore_hyd %>%
select(combined_labeler_name, reporter_name, buyer_name, dosage_unit, transaction_date) %>%
unite(pipeline, combined_labeler_name, reporter_name, buyer_name, remove='F', sep = "--") %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipments = mean(dosage_unit),
max_pills_in_shipments = max(dosage_unit)
)
baltimore %>%
mutate(rite_aid_y_n = if_else(buyer_name == "RITE AID", "rite_aid_y", "rite_aid_n"))
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group))%>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
baltimore %>%
select(combined_labeler_name, reporter_name, buyer_name, dosage_unit, transaction_date) %>%
unite(pipeline, combined_labeler_name, reporter_name, buyer_name, remove='F', sep = "--") %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipments = mean(dosage_unit),
max_pills_in_shipments = max(dosage_unit)
)
Collapse
baltimore %>%
select(combined_labeler_name, reporter_name, buyer_name, dosage_unit, transaction_date) %>%
unite(pipeline, combined_labeler_name, reporter_name, buyer_name, remove='F', sep = "--") %>%
group_by(pipeline) %>%
summarise(shipments = n(),
total_pills = sum(dosage_unit),
avg_pills_per_shipments = mean(dosage_unit),
max_pills_in_shipments = max(dosage_unit)
)
baltimore %>%
mutate(pills_category = case_when(
buyer_name == "RITE AID" ~ "rite_aid_y",
buyer_name !x "RITE AID" ~ "rite_aid_n",
baltimore %>%
mutate(rite_aid_y_n = case_when(str_detect(buyer_name, "RITE") ~ "rite_aid_y", TRUE ~ "rite_aid_n")) %>%
group_by(rite_aid_y_n) %>%
summarise(shipments_per_group = sum(quantity)) %>%
mutate(city_shipments = sum(shipments_per_group)) %>%
mutate(percent_total_shipments = round(((shipments_per_group/city_shipments)*100),2))
