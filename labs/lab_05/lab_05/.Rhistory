knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
install.packages("lubridate", repos = "https://lubridate.tidyverse.org/")
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Load data and store it as an object called Mingo
mingo <- read_tsv("data/arcos-wv-mingo-54059-itemized.tsv")
# Load data and store it as an object called Mingo
mingo <- read_tsv("data/arcos-wv-mingo-54059-itemized.tsv")
mingo <- read_tsv("data/arcos-wv-mingo-54059-itemized.tsv")
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load data and store it as an object called Mingo
mingo <- read_tsv("data/arcos-wv-mingo-54059-itemized.tsv")
glimpse(mingo)
view(mingo)
# Use the clean_names function in janitor to make all of the columns lowercase.
mingo <- clean_names(mingo)
# Use the clean_names function in janitor to make all of the columns lowercase.
mingo <- clean_names(mingo)
mingo <- mingo %>%
mutate(transaction_date = mdy(transaction_date)) %>%
select(transaction_date, everything())
mingo <- mingo %>%
mutate(transaction_date = mdy(transaction_date)) %>%
select(transaction_date, everything())
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
install.packages('Rtools', repos = "https://cran.rstudio.com/bin/windows/Rtools/"")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
install.packages("lubridate", repos = "https://lubridate.tidyverse.org/")
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
install.packages('Rtools', repos = "https://cran.rstudio.com/bin/windows/Rtools/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load data and store it as an object called Mingo
mingo <- read_tsv("data/arcos-wv-mingo-54059-itemized.tsv")
glimpse(mingo)
view(mingo)
# Use the clean_names function in janitor to make all of the columns lowercase.
mingo <- clean_names(mingo)
# Use the clean_names function in janitor to make all of the columns lowercase.
mingo <- clean_names(mingo)
mingo <- mingo %>%
mutate(transaction_date = mdy(transaction_date)) %>%
select(transaction_date, everything())
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Install lubridate package
install.packages('Lubridate', repos = "https://lubridate.tidyverse.org/")
install.packages('Rtools', repos = "https://cran.rstudio.com/bin/windows/Rtools/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
# Load data and store it as an object called Mingo
mingo <- read_tsv("data/arcos-wv-mingo-54059-itemized.tsv")
glimpse(mingo)
view(mingo)
# Use the clean_names function in janitor to make all of the columns lowercase.
mingo <- clean_names(mingo)
mingo <- mingo %>%
mutate(transaction_date = mdy(transaction_date)) %>%
select(transaction_date, everything())
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
install.packages('Rtools', repos = "https://cran.rstudio.com/bin/windows/Rtools/")
install.packages("lubridate", repos = "https://lubridate.tidyverse.org/")
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
# Install lubridate package
install.packages('lubridate', repos = "https://lubridate.tidyverse.org/")
install.packages('Rtools', repos = "https://cran.rstudio.com/bin/windows/Rtools/")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
library(lubridate)
# Load data and store it as an object called Mingo
mingo <- read_tsv("data/arcos-wv-mingo-54059-itemized.tsv")
glimpse(mingo)
view(mingo)
# Use the clean_names function in janitor to make all of the columns lowercase.
mingo <- clean_names(mingo)
mingo <- mingo %>%
mutate(transaction_date = mdy(transaction_date)) %>%
select(transaction_date, everything())
glimpse(mingo)
mingo %>%
arrange(transaction_date)
mingo %>%
filter(transaction_date == as_date("2006-10-31"))
mingo %>%
filter(transaction_date == as_date("2006-10-31"))
mingo <- mingo %>%
mutate(transaction_year = year(transaction_date)) %>%
select(transaction_date, transaction_year, everything())
mingo %>%
group_by(transaction_year) %>%
summarise(total_shipments = n())
mingo %>%
group_by(transaction_year) %>%
summarise(DOSAGE_UNIT = n())
mingo %>%
group_by(transaction_year) %>%
summarise(DOSAGE_UNIT = n())
sum(DOSAGE_UNIT = n())
mingo %>%
group_by(transaction_year) %>%
summarise(DOSAGE_UNIT = n())
#
mingo %>%
group_by(transaction_year) %>%
summarise(DOSAGE_UNIT = n())
#There were 4,192 total pills shipped to Mingo County in 2006, 5,389 in 2007, 7,496 in 2008, 7,227 in 2009, 4,466 in 2010, 4,243 in 2011 nd 4,141 in 2012. The overall trend was lowest at the beginning and end of the time frame, with spikes in the middle to the highest points (7,496 in 2008 and 7,227 in 2009).
county_pills_per_year <- read_csv("data/county_pills_per_year.csv")
View(county_pills_per_year)
View(county_pills_per_year)
county_population_per_year <- read_csv("data/county_population_per_year.csv")
pills_population <- county_pills_per_year %>%
inner_join(county_population_per_year, by="countyfips")
View(pills_population)
pills_population <- pills_population %>%
select(countyfips, buyer_county.x, buyer_state.x, average_pills_per_year, average_population_per_year) %>%
rename(buyer_county = buyer_county.x, buyer_state = buyer_state.x)
pills_population <- pills_population %>%
select(countyfips, buyer_county.x, buyer_state.x, average_pills_per_year, average_population_per_year) %>%
rename(buyer_county = buyer_county.x, buyer_state = buyer_state.x)
pills_population <- county_pills_per_year %>%
inner_join(county_population_per_year, by="countyfips")
pills_population <- pills_population %>%
select(countyfips, buyer_county.x, buyer_state.x, average_pills_per_year, average_population_per_year) %>%
rename(buyer_county = buyer_county.x, buyer_state = buyer_state.x)
pills_population %>%
mutate(avg_yearly_pills_per_person = average_pills_per_year/average_population_per_year) %>%
select(buyer_county, buyer_state, avg_yearly_pills_per_person, average_pills_per_year, average_population_per_year, countyfips) %>%
arrange(desc(avg_yearly_pills_per_person))
pills_population_left <- county_pills_per_year %>%
left_join(county_population_per_year, by="countyfips")
pills_population_right <- county_pills_per_year %>%
right_join(county_population_per_year, by="countyfips")
pills_population_full <- county_pills_per_year %>%
full_join(county_population_per_year, by="countyfips")
mingo_buyer_per_year <- read_csv("data/mingo_buyer_per_year.csv")
mingo_buyer_addresses <- read_csv("data/mingo_buyer_addresses.csv")
mingo_buyer_join <- mingo_buyer_per_year %>%
inner_join(mingo_buyer_addresses, by="buyer_dea_no")
pills_population_oops <- county_pills_per_year %>%
inner_join(county_population_per_year, by="buyer_county")
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, paged.print=TRUE)
buyer_addresses_and_total_pills <- buyer_totals %>%
inner_join(buyer_addresses, by="dosage_unit")
# Load Tidyverse and Janitor
library(tidyverse)
library(janitor)
library(lubridate)
buyer_addresses_and_total_pills <- buyer_totals %>%
inner_join(buyer_addresses, by="dosage_unit")
buyer_addresses <- read_csv("data/buyer_addresses.csv")
buyer_totals <- read_csv("data/buyer_totals.csv")
buyer_annual_by_year <- read_csv("data/buyer_annual_by_year.csv")
state_population_per_year <- read_csv("data/state_population_per_year.csv")
buyer_addresses_and_total_pills <- buyer_totals %>%
inner_join(buyer_addresses, by="dosage_unit")
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
glimpse(buyer_totals)
glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
glimpse(buyer_addresses)
glimpse(buyer_totals)
#glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
buyer_addresses_and_total_pills <- buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no")
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no")
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no")%>%
arrange(total_pills)
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no")%>%
arrange(desc(total_pills)
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no")%>%
arrange(desc(total_pills)
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no")%>%
arrange(total_pills)
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no")%>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no"%>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(-"pharmacy")
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_addresses, -"pharmacy")
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_addresses, -"pharmacy"))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_addresses, -"pharmacy")
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_name, -"pharmacy")
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
glimpse(buyer_addresses)
glimpse(buyer_totals)
glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_bus_act = "PRACTITIONER")
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_bus_act == "PRACTITIONER")
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_bus_act == "PRACTITIONER")%>%
arrange(desc(total_pills))
buyer_addresses <- read_csv("data/buyer_addresses.csv")
buyer_totals <- read_csv("data/buyer_totals.csv")
buyer_annual_by_year <- read_csv("data/buyer_annual_by_year.csv")
state_population_per_year <- read_csv("data/state_population_per_year.csv")
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_bus_act == "PRACTITIONER")%>%
arrange(desc(total_pills))
view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
#glimpse(buyer_totals)
#glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")%>%
filter(buyer_bus_act == "PRACTITIONER")%>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no")#%>%
#filter(buyer_bus_act == "PRACTITIONER")%>%
#           arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
#           arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
group_by(transaction_year == 2010) %>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
#group_by(transaction_year == 2010) %>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
mutate(transaction_year = year(transaction_date)) %>%
arrange(desc(total_pills))
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
#glimpse(buyer_totals)
glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
#view(buyer_addresses)
#view(buyer_totals)
view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
#glimpse(buyer_totals)
#glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
filter (year =="2010")%>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
filter (year == "2010")%>%
arrange(desc(total_pills))
buyer_totals %>%
full_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
filter (year == "2010")%>%
arrange(desc(total_pills))
buyer_totals %>%
left_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
filter (year == "2010")%>%
arrange(desc(total_pills))
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
filter (year == "2010")%>%
arrange(desc(total_pills))
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no") #%>%
# filter(buyer_bus_act.x == "PRACTITIONER")%>%
#filter (year == "2010")%>%
# arrange(desc(total_pills))
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no") #%>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
#filter (year == "2010")%>%
# arrange(desc(total_pills))
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER")%>%
#filter (year == "2010")%>%
# arrange(desc(total_pills))
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
#filter (year == "2010")%>%
arrange(desc(total_pills))
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
arrange(desc(total_pills)) %>%
filter (year == "2010")
buyer_totals %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
arrange(desc(total_pills)) %>%
filter (year == "2010")
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
arrange(desc(total_pills)) %>%
filter (year == "2010")
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
arrange(desc(dosage_unit)) %>%
filter (year == "2010")
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
filter (year == "2010")
arrange(desc(dosage_unit)) %>%
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
filter (year == "2010") %>%
arrange(desc(dosage_unit))
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
filter(buyer_state=="MD")
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
filter(buyer_state=="MD") %>%
filter (year == "2010") %>%
arrange(desc(dosage_unit))
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
filter(state=="MD") %>%
filter (year == "2010") %>%
arrange(desc(dosage_unit))
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
filter(buyer_state=="MD") %>%
filter (year == "2010") %>%
arrange(desc(dosage_unit))
buyer_annual_by_year %>%
inner_join(buyer_addresses, by="buyer_dea_no") %>%
filter(buyer_bus_act.x == "PRACTITIONER") %>%
filter(buyer_state.x=="MD") %>%
filter (year == "2010") %>%
arrange(desc(dosage_unit))
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
#glimpse(buyer_totals)
glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
#glimpse(buyer_totals)
#glimpse(buyer_annual_by_year)
glimpse(state_population_per_year)
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
#glimpse(buyer_totals)
glimpse(buyer_annual_by_year)
#glimpse(state_population_per_year)
pills_by_state <- buyer_annual_by_year %>%
inner_join(buyer_state, by "dosage_unit") %>%
buyer_annual_by_year %>%
inner_join(buyer_state, by "dosage_unit") %>%
buyer_annual_by_year %>%
inner_join(buyer_state, by "buyer_dea_no") %>%
#view(buyer_addresses)
#view(buyer_totals)
#view(buyer_annual_by_year)
#view(state_population_per_year)
#glimpse(buyer_addresses)
#glimpse(buyer_totals)
glimpse(buyer_annual_by_year)
glimpse(state_population_per_year)
buyer_annual_by_year %>%
inner_join(buyer_state, by "buyer_state") %>%
